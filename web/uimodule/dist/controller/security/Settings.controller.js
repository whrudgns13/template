sap.ui.define(["../BaseController","../../model/formatter"],function(e,t){"use strict";return e.extend("com.myorg.myUI5App.security.Settings",{formatter:t,onBeforeRendering:function(){const e=this.getView();const t=new sap.ui.model.json.JSONModel({enabled:false,visible:true});e.setModel(t,"setting");this._slider=e.getModel("setting");this.getSetting()},getSetting:function(){const e=this;jQuery.ajax({url:"/app/security",type:"GET",async:false,headers:{"X-CSRF-Token":"Fetch"},success:function(t,n,s){e.csrfToken=s.getResponseHeader("x-csrf-token");t.tokenPolicySettings=e.tokenTimeConversion(t.tokenPolicySettings);e._slider.setProperty("/security",t)},error:function(e){console.log(e)}})},tokenTimeConversion:function(e){e.accessTokenValidity=e.accessTokenValidity/60;e.refreshTokenValidity=e.refreshTokenValidity/3600;return e},getUpdateTokenSettings:function(){const e=this._slider.getProperty("/security/tokenPolicySettings/accessTokenValidity")*60;const t=this._slider.getProperty("/security/tokenPolicySettings/refreshTokenValidity")*3600;const n={tokenPolicySettings:{accessTokenValidity:e,refreshTokenValidity:t}};return n},onTokenTimeSave:function(){const e=this;jQuery.ajax({url:"/app/security",data:JSON.stringify(e.getUpdateTokenSettings()),type:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-Token":e.csrfToken},success:function(t,n,s){if(n==="success")new sap.m.MessageToast.show("변경 성공");e.onChangeState()},error:function(e){console.log(e)}})},onChangeState:function(){let e=this._slider.getProperty("/enabled");let t=this._slider.getProperty("/visible");this._slider.setProperty("/enabled",!e);this._slider.setProperty("/visible",!t)}})});